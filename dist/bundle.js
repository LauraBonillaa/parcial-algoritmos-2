(()=>{"use strict";var t,e;(e=t||(t={})).GET_PRODUCTS="GET_PRODUCTS",e.ADD_TASK="ADD_TASK",e.REMOVE_TASK="REMOVE_TASK";let n=(t=>{const e=localStorage.getItem(t)||sessionStorage.getItem(t);return e?JSON.parse(e):{screen:"DASHBOARD",products:[]}})("STORE"),o=[];const s=e=>{const s=((e,n)=>{const{action:o,payload:s}=e;switch(o){case t.GET_PRODUCTS:return Object.assign(Object.assign({},n),{products:s});case t.ADD_TASK:return Object.assign(Object.assign({},n),{tasks:[...n.tasks,s]});case t.REMOVE_TASK:return Object.assign(Object.assign({},n),{products:n.products.filter((t=>t.id!==s))});default:return n}})(e,JSON.parse(JSON.stringify(n)));n=s,o.forEach((t=>t.render())),((t,e,n=!1)=>{const o=n?sessionStorage:localStorage,s=JSON.stringify(e);o.setItem(t,s)})("STORE",s)},r=t=>{o=[...o,t]};const i=()=>{return e=void 0,n=void 0,s=function*(){const e=yield(n=void 0,o=void 0,s=void 0,r=function*(){try{const t=yield fetch("https://fakestoreapi.com/products").then((t=>t.json()));return console.log(t),t}catch(t){console.error(t)}},new(s||(s=Promise))((function(t,e){function i(t){try{a(r.next(t))}catch(t){e(t)}}function c(t){try{a(r.throw(t))}catch(t){e(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof s?n:new s((function(t){t(n)}))).then(i,c)}a((r=r.apply(n,o||[])).next())})));var n,o,s,r;return{action:t.GET_PRODUCTS,payload:e}},new((o=void 0)||(o=Promise))((function(t,r){function i(t){try{a(s.next(t))}catch(t){r(t)}}function c(t){try{a(s.throw(t))}catch(t){r(t)}}function a(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,c)}a((s=s.apply(e,n||[])).next())}));var e,n,o,s};var c;!function(t){t.uid="uid",t.image="image",t.name="name",t.description="description",t.category="category",t.price="price",t.rating="rating"}(c||(c={}));class a extends HTMLElement{static get observedAttributes(){return Object.keys(c)}attributeChangedCallback(t,e,n){t===c.price||t===c.rating||t===c.uid?this[t]=n?Number(n):void 0:this[t]=n,this.render()}constructor(){super(),this.attachShadow({mode:"open"}),r(this)}connectedCallback(){this.render()}render(){var e;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n            <link rel="stylesheet" href="../src/components/ProductItem/ProductItem.css">\n            <section>\n            <div  class="card">\n            <div id="character">\n            <img id="img" src="${this.image?this.image:"Not found"}">\n            <div class="text">\n            <h2 class="name">${this.name}</h2>\n            <p>Description: ${this.description}</p>\n            <p>Category: ${this.category}</p>\n            <p>Price: $${this.price}</p>\n            <p>Rating: ${this.rating}</p>\n            <button id="add-button">Editar</button>\n            <button id="remove-button">Eliminar</button>\n            </div>\n            </div>\n            </div>\n            \n            </section>\n            `,(null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#remove-button")).addEventListener("click",(()=>{const e=Number(this.getAttribute("id"));var n;s((n=e,{action:t.REMOVE_TASK,payload:n}))})))}}customElements.define("card-product",a);class d extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),r(this)}connectedCallback(){return t=this,e=void 0,r=function*(){if(console.log("holi"),n.products&&0!==n.products.length)console.log("Products already loaded:",n.products);else{const t=yield i();s(t),console.log("Products state after fetch:",n.products)}this.render()},new((o=void 0)||(o=Promise))((function(n,s){function i(t){try{a(r.next(t))}catch(t){s(t)}}function c(t){try{a(r.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(i,c)}a((r=r.apply(t,e||[])).next())}));var t,e,o,r}fetchProducts(){if(!n.products||0===n.products.length)return console.log("No products available in the state."),null;const t=document.createElement("section");return t.className="products-container",n.products.forEach((e=>{const n=document.createElement("card-product");n.setAttribute(c.uid,e.id.toString()),n.setAttribute(c.image,e.image),n.setAttribute(c.name,e.title),n.setAttribute(c.description,e.description),n.setAttribute(c.category,e.category),n.setAttribute(c.price,e.price.toString()),n.setAttribute(c.rating,e.rating.rate.toString()),t.appendChild(n)})),console.log("Products rendered:",n.products),t}render(){if(this.shadowRoot){this.shadowRoot.innerHTML="";const t=this.ownerDocument.createElement("h2");t.textContent="Product List",this.shadowRoot.appendChild(t);const e=this.fetchProducts();e?this.shadowRoot.appendChild(e):this.shadowRoot.innerHTML+="<p>no encontre los productos :( </p>"}}}customElements.define("app-dashboard",d);class u extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var t;if(this.shadowRoot&&(this.shadowRoot.innerHTML=""),"DASHBOARD"===n.screen){const e=document.createElement("app-dashboard");null===(t=this.shadowRoot)||void 0===t||t.appendChild(e)}else console.log("Not found")}}customElements.define("app-container",u)})();